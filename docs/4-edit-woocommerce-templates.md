# Edit WooCommerce Templates

## Search Keywords

- How to edit WooCommerce templates?
- Customize WooCommerce template files

- There're two ways to customize `WooCommerce` template files:
  1. By overriding template files
  2. By using hooks (Actions & filters)

## Method 1: Overriding WooCommerce Files

> This method is well-documented in the original file template!

- Copy file from `WooCommerce` plugin
- Paste it in the root theme folder, in `WooCommerce` sub directory
- Customize the template using HTML or add more PHP hooks

> **Demo:** See `/woocommerce/archive-product.php` file.

## Drawbacks of This Method

- This method requires try and error, many times
- WooCommerce changes from time to time, so you will track the changes made on their files, especially `hooks`, then update your code.
- You can track the changes by going to `WooCommerce -> status`, and you will see all the files overridden.
- Fortunately, the changes to temp files are rare!

## Method 1 Example: Modifying Shop Page `archive-product.php`

### My Modifications

1. Wrap all hooks inside `<div class="container"><div class="row">`
2. Create 2 columns, 1 for sidebar, and another for the main content

**Note:** `PHP` original comments has been removed from this file.

```php
<?php
defined( 'ABSPATH' ) || exit;

get_header( 'shop' );
?>
// 1. Wrap the document with `container` and `row`
<div class="container">
  <div class="row">
    // 2. Create a column for the main content
    <div class="col-lg-9 col-md-8 order-1 order-md-2">
    <?php
      do_action( 'woocommerce_before_main_content' );?>

        <header class="woocommerce-products-header">
          <?php
            if ( apply_filters( 'woocommerce_show_page_title', true ) ) : ?>
              <h1 class="woocommerce-products-header__title page-title"><?php woocommerce_page_title(); ?></h1>
            <?php endif; ?>

          <?php
            do_action( 'woocommerce_archive_description' ); ?>
        </header>
    <?php
      if ( woocommerce_product_loop() ) {
        do_action( 'woocommerce_before_shop_loop' );
        woocommerce_product_loop_start();

      if ( wc_get_loop_prop( 'total' ) ) {
        while ( have_posts() ) {
          the_post();

          do_action( 'woocommerce_shop_loop' );
          wc_get_template_part( 'content', 'product' );
        }
      }

        woocommerce_product_loop_end();
        do_action( 'woocommerce_after_shop_loop' );
      } else {
        do_action( 'woocommerce_no_products_found' );
      }

      do_action( 'woocommerce_after_main_content' ); ?>
    </div>
    // 3. Create a column for the sidebar
    <div class="col-lg-3 col-md-4 order-2 order-md-1">
      <?php
  		  do_action( 'woocommerce_sidebar' ); ?>
    </div>
  </div>
</div>

<?php get_footer( 'shop' );
```

## Method 2: Modifying of Shop Page Using `WooCommerce` Actions and Filters Hooks

- It's recommended by `WooCommerce` community.
- You will apply very few changes to the template files.
- No need to copy the original `WooCommerce` file, that means, you don't need to apply any change in the original file / template.
- It's more complicated, and takes time to understand the process.

### How it Works

- Use `Simple show hooks` plugin.
- Show all hooks by clicking on the plugin option in the admin bar.
- You can see the name of function used in the hook by hovering over the `hook`.
- In `WordPress`, each `add_action` corresponds with 1 `do_action` hook.

### Method Issues When I Applied the Changes

- When I applied the function in the `hook` of `woocommerce_before_main_content`, the wrapper `container` and `row` divs didn't placed at the right position in the DOM! Why? Because the priority was 10!
- Pay attention! if you placed the closing `container` and `row` divs in the `woocommerce_after_main_content` hook, you will wrap the first column only!

```php
<?php
/** Modifying WooCommerce templates using actions and filters hooks
 * 1. Add container and row wrappers
 * 2. Add closing tags of container and row wrappers
 * 3. Remove default sidebar to be echoed later inside new sidebar tags
 * 4. Adding sidebar again after removing default sidebar that's generated by woocommerce. We remove it because it's in the wrong place!
 * 4.A. Add sidebar tags
 * 4.B. Add sidebar again using another hook (custom)
 * 4.C. Add closing sidebar tags
 * 5. If we in Shop page, add a short description to the product
 * 6. Add opening shop tags
 * 7. Add closing shop tags
 */

function fancy_lab_wc_modify() {
  // 1. Add opening container and row wrappers tags
  function fancy_lab_open_container_row() {
    echo '<div class="container shop-content"><div class="row">';
  }

  add_action( 'woocommerce_before_main_content', 'fancy_lab_open_container_row', 5 ); // must have priority greater than 10, the default priority is 10

  // 2. Add closing container and row wrappers tags
  function fancy_lab_close_container_row() {
    echo '</div></div>';
  }

  add_action( 'woocommerce_after_main_content', 'fancy_lab_close_container_row', 5 ); // should have the same priority as <opening tags>

  // 3. Remove default sidebar to be echoed later inside new sidebar tags
  remove_action( 'woocommerce_sidebar', 'woocommerce_get_sidebar' );

  // Add sidebar only to shop page and remove it from other pages
  if ( is_shop() ) {
    // 4. Adding sidebar again after removing default sidebar that's generated by woocommerce. We remove it because it's in the wrong place!
    // 4.A. Add sidebar opening tags
    function fancy_lab_open_sidebar_tags() {
      echo '<div class="sidebar-shop col-lg-3 col-md-4 order-2 order-md-1">';
    }

    add_action( 'woocommerce_before_main_content', 'fancy_lab_open_sidebar_tags', 6 ); // (6) because we want it inside .container and row wrappers, which have a value of (5)

    // 4.B. Add sidebar again using another hook (custom)
    add_action( 'woocommerce_before_main_content', 'woocommerce_get_sidebar', 7 ); // (6: tags, 7: get_sidebar)

    // 4.C. Add closing sidebar tags
    function fancy_lab_close_sidebar_tags() {
      echo '</div>';
    }

    add_action( 'woocommerce_before_main_content', 'fancy_lab_close_sidebar_tags', 8 );

    // 5. If we in Shop page, add a short description to the product
    add_action( 'woocommerce_after_shop_loop_item_title', 'the_excerpt', 1 );
  }

  // 6. Add opening shop tags
  function fancy_lab_open_shop_tags() {
    // The content size for shop page is 9 col, for other pages is 12
    if ( is_shop() ) {
      echo '<div class="col-lg-9 col-md-8 order-1 order-md-2">';
    } else {
      echo '<div class="col">';
    }
  }

  add_action( 'woocommerce_before_main_content', 'fancy_lab_open_shop_tags', 9 );

  // 7. Add closing shop tags
  function fancy_lab_close_shop_tags(){
    echo '</div>';
  }

  add_action( 'woocommerce_after_main_content', 'fancy_lab_close_shop_tags', 4 );


  /**
   * Filters return only true or false
   * Filter: input -> processing -> output
   */

  /*
  function fancy_lab_remove_shop_title( $val ) { // input
    $val = false; // processing (You can't return a string, just bool)
    return $val; // output
    // If one $param, you can write the function in a simpler way function x() { return false }
  }

  add_filter( 'woocommerce_show_page_title', 'fancy_lab_remove_shop_title' );
  */

}

add_action( 'wp', 'fancy_lab_wc_modify' );
```

## Modifying Single Product Template `single-product.php`

- In this template, we applied styles in CSS in general, then we excluded the `Shop` page from our applied styles using `WordPress conditional tags -> is_shop()`.

## Modifying Cart Page

Unfortunately! This page doesn't come with file template like `Shop` page, it comes from `page.php` WordPress template. The only way to edit this template is to edit `page.php` and apply general styles.

All the functionality in this pages comes from the shortcode `[woocommerce_cart]`.

## Modifying Checkout Page

- This page is also comes from `page.php` template.
- The best solution is to override the default `WooCommerce` style, which is like a `grid` system, in your custom style.
- You can start the modification by inspecting the elements, then search in your code with the corresponding class names.

### Changes Applied Using `CSS`

- In `wc-grid.css` file, I updated the style of `Checkout` page using these rules:

```css
.woocommerce .col2-set .col-1,
.woocommerce .col2-set .col-2 {
	flex: 0 0 50%;
	max-width: 50%;
}
```

## Modifying Account Page

- Allow for at least 1 payment method from `WooCommerce -> Payments`.

## Adding Shopping Cart

### Showing the Cart in the Top Bar

- Adding the shopping cart link.
- Adding the shopping cart items count.

```php
<?php
<div class="cart text-right">
  <a href="<?php echo esc_url( wc_get_cart_url() ); ?>">
    <span class="cart-icon"></span>
  </a>
  <span class="items"><?php echo esc_html( WC()->cart->get_cart_contents_count() ); ?></span>
</div>
```

### Update Shopping Cart Without Refresh (Ajax)

```php
function fancy_lab_woocommerce_header_add_to_cart_fragment( $fragments ) {
	global $woocommerce;

	add_filter( 'woocommerce_add_to_cart_fragments', 'fancy_lab_woocommerce_header_add_to_cart_fragment' );

	ob_start(); ?>

  // The HTML tag we specified for shopping cart item
  <span class="items"><?php echo WC()->cart->get_cart_contents_count(); ?></span>

<?php
	$fragments['span.items'] = ob_get_clean();
	return $fragments;
}
```

## Add Login/Logout in the Header

- To allow registration in `My account page`, go to `WooCommerce -> Settings -> Accounts and privacy -> Allow customers to create an account on the "My account" page`

```php
<?php if ( class_exists( 'WooCommerce' ) ) { ?>
<div class="account col-12">
  <div class="navbar-expand">
    <ul class="navbar-nav float-left">
      <?php if ( is_user_logged_in() ) { ?>
      <li>
        <a href="<?php echo esc_url( get_permalink( get_option( 'woocommerce_myaccount_page_id' ) ) ); ?>"
          class="nav-link"><?php esc_html_e( 'My Account', 'fancy-lab' ); ?></a>
      </li>
      <li>
        <a href="<?php echo esc_url( wp_logout_url( get_permalink( get_option( 'woocommerce_myaccount_page_id' ) ) ) ); ?>"
          class="nav-link"><?php esc_html_e( 'Logout', 'fancy-lab' ); ?></a>
      </li>
      <!-- To allow registration in My account page, go to WooCommerce -> Settings -> Accounts and privacy -> `Allow customers to create an account on the "My account" page` -->
      <?php } else { ?>
      <li>
        <a href="<?php echo esc_url( get_permalink( get_option( 'woocommerce_myaccount_page_id' ) ) ); ?>"
          class="nav-link"><?php esc_html_e( 'Login / Register', 'fancy-lab' ); ?></a>
      </li>
      <?php } ?>
    </ul>
  </div>
```

## Add Custom Logo Feature in Customizer

### Add Support for Custom Logo

- The `flex_height` and `flex_width` properties are for flexible size logo, if you don't pass theme, the logo will be with the exact size you've specified.

```php
// Appears in: Appearance -> Customize -> Site identity
add_theme_support( 'custom-logo', array(
  'height'			=> 85,
  'width'				=> 160,
  'flex_height'	=> true,
  'flex_width'	=> true
) );
```

### Show the Logo of the Website

```php
<!-- Dynamic/custom logo feature -->
<a href="<?php echo esc_url( home_url( '/' ) ); // or site_url() ?>">
  <?php if ( has_custom_logo() ) {
    the_custom_logo();
  } else { ?>
  <p><?php bloginfo( 'title' ); ?></p>
  <span><?php bloginfo( 'description' ); ?></span>
  <?php } ?>
</a>
```

## Build Theme Customizer

### Add Theme Copyright Section Support

1. Create the section.
2. Create the settings responsible to store values in DB, in `wp_options` table.
3. Create fields for each section to store data.

```php
function fancy_lab_customizer( $wp_customize ) { // $wp_customize is built-in object to add features to

  // Add copyright section
  $wp_customize->add_section(
    'sec_copyright', array(
			'title'		  	=> __( 'Copyright Settings', 'fancy-lab' ),
			'description'	=> __( 'Copyright Section', 'fancy-lab' )
		)
  );

  // Field 1, copyright text field
  $wp_customize->add_setting(
    'set_copyright', array(
      'title'             => 'theme_mod',
      'default'           => '',
      'sanitize_callback' => 'sanitize_text_field'
    )
  );

  $wp_customize->add_control(
    'set_copyright', array(
      'label'			  => __( 'Copyright', 'fancy-lab' ),
			'description'	=> __( 'Please, add your copyright information here', 'fancy-lab' ),
      'section'     => 'sec_copyright', // The section to add control to
      'type'        => 'text' // type of field (text, radio, ...)
    )
  );
}

add_action( 'customize_register', 'fancy_lab_customizer' );
```

### Show Theme Copyright Section Content

- Pass default string/copyright if the customizer has no value!

```php
<div class="copyright-text col-12 col-md-6">
  <p><?php echo esc_html ( get_theme_mod( 'set_copyright', __( 'Copyright X - All Rights Reserved', 'fancy-lab' ) ) ); ?>
  </p>
</div>
```

## Add Slider With Theme Customizer

Because we want to distribute theme, we can't depend on third party plugins, as well as `Custom Post Types` and `Shortcodes`! So, we'll create dynamic slider with `Theme Customizer`.

### Enqueue Flex Slider Scripts and Styles

- Include the `flex slider` assets in the project

### Create Separate Page for Every Slider

- Add support of custom image size in `features.php`.
- Write the content of the pages (Slides).
- Upload a featured image for each slide.

```php
add_image_size( 'fancy-lab-slider', 1920, 800, array('center', 'center') );
```

### Adding Slider's Slides Dynamically Using Theme Customizer

```php
function fancy_lab_customizer( $wp_customize ) {
  // Slider Section
	$wp_customize->add_section(
		'sec_slider', array(
			'title'			  => __( 'Slider Settings', 'fancy-lab' ),
			'description'	=> __( 'Slider Section', 'fancy-lab' )
		)
	);

  // Field 1 - Slider Page Number 1
  $wp_customize->add_setting(
    'set_slider_page_1', array(
      'type'					      => 'theme_mod',
      'default'			      	=> '',
      'sanitize_callback'   => 'absint'
    )
  );

  $wp_customize->add_control(
    'set_slider_page_1', array(
      'label'			  => __( 'Set slider page 1', 'fancy-lab' ),
      'description'	=> __( 'Set slider page 1', 'fancy-lab' ),
      'section'		  => 'sec_slider',
      'type'			  => 'dropdown-pages'
    )
  );

  // Field 2 - Slider Button Text Number 1
  $wp_customize->add_setting(
    'set_slider_button_text_1', array(
      'type'					      => 'theme_mod',
      'default'				      => '',
      'sanitize_callback'		=> 'sanitize_text_field'
    )
  );

  $wp_customize->add_control(
    'set_slider_button_text_1', array(
      'label'			  => __( 'Button Text for Page 1', 'fancy-lab' ),
      'description'	=> __( 'Button Text for Page 1', 'fancy-lab' ),
      'section'		  => 'sec_slider',
      'type'			  => 'text'
    )
  );

  // Field 3 - Slider Button URL Number 1
  $wp_customize->add_setting(
    'set_slider_button_url_1', array(
      'type'					      => 'theme_mod',
      'default'				      => '',
      'sanitize_callback'		=> 'esc_url_raw'
    )
  );

  $wp_customize->add_control(
    'set_slider_button_url_1', array(
      'label'			  => __( 'URL for Page 1', 'fancy-lab' ),
      'description'	=> __( 'URL for Page 1', 'fancy-lab' ),
      'section'		  => 'sec_slider',
      'type'			  => 'url'
    )
  );

  // Field 4 - Slider Page Number 2
  $wp_customize->add_setting(
    'set_slider_page_2', array(
      'type'					      => 'theme_mod',
      'default'				      => '',
      'sanitize_callback'		=> 'absint'
    )
  );

  $wp_customize->add_control(
    'set_slider_page_2', array(
      'label'			  => __( 'Set slider page 2', 'fancy-lab' ),
      'description'	=> __( 'Set slider page 2', 'fancy-lab' ),
      'section'		  => 'sec_slider',
      'type'			  => 'dropdown-pages'
    )
  );

  // Field 5 - Slider Button Text Number 2
  $wp_customize->add_setting(
    'set_slider_button_text_2', array(
      'type'					      => 'theme_mod',
      'default'				      => '',
      'sanitize_callback'		=> 'sanitize_text_field'
    )
  );

  $wp_customize->add_control(
    'set_slider_button_text_2', array(
      'label'			  => __( 'Button Text for Page 2', 'fancy-lab' ),
      'description'	=> __( 'Button Text for Page 2', 'fancy-lab' ),
      'section'		  => 'sec_slider',
      'type'			  => 'text'
    )
  );

  // Field 6 - Slider Button URL Number 2
  $wp_customize->add_setting(
    'set_slider_button_url_2', array(
      'type'					      => 'theme_mod',
      'default'				      => '',
      'sanitize_callback'		=> 'esc_url_raw'
    )
  );

  $wp_customize->add_control(
    'set_slider_button_url_2', array(
      'label'			  => __( 'URL for Page 2', 'fancy-lab' ),
      'description'	=> __( 'URL for Page 2', 'fancy-lab' ),
      'section'		  => 'sec_slider',
      'type'			  => 'url'
    )
  );

  // Field 7 - Slider Page Number 3
  $wp_customize->add_setting(
    'set_slider_page_3', array(
      'type'					      => 'theme_mod',
      'default'				      => '',
      'sanitize_callback'		=> 'absint'
    )
  );

  $wp_customize->add_control(
    'set_slider_page_3', array(
      'label'			  => __( 'Set slider page 3', 'fancy-lab' ),
      'description'	=> __( 'Set slider page 3', 'fancy-lab' ),
      'section'		  => 'sec_slider',
      'type'			  => 'dropdown-pages'
    )
  );

  // Field 8 - Slider Button Text Number 3
  $wp_customize->add_setting(
    'set_slider_button_text_3', array(
      'type'					      => 'theme_mod',
      'default'				      => '',
      'sanitize_callback'		=> 'sanitize_text_field'
    )
  );

  $wp_customize->add_control(
    'set_slider_button_text_3', array(
      'label'			  => __( 'Button Text for Page 3', 'fancy-lab' ),
      'description'	=> __( 'Button Text for Page 3', 'fancy-lab' ),
      'section'		  => 'sec_slider',
      'type'			  => 'text'
    )
  );

  // Field 9 - Slider Button URL Number 3
  $wp_customize->add_setting(
    'set_slider_button_url_3', array(
      'type'					      => 'theme_mod',
      'default'				      => '',
      'sanitize_callback'		=> 'esc_url_raw'
    )
  );

  $wp_customize->add_control(
    'set_slider_button_url_3', array(
      'label'			  => __( 'URL for Page 3', 'fancy-lab' ),
      'description'	=> __( 'URL for Page 3', 'fancy-lab' ),
      'section'		  => 'sec_slider',
      'type'			  => 'url'
    )
  );

  // Homepage Settings
  $wp_customize->add_section(
    'sec_home_page', array(
      'title'			  => __( 'Home Page Products and Blog Settings', 'fancy-lab' ),
      'description'	=> __( 'Home Page Section', 'fancy-lab' )
    )
  );

  // Field 1: Popular products title
  $wp_customize->add_setting(
    'set_popular_title', array(
      'type' 			      	=> 'theme_mod',
      'default' 		    	=> '',
      'sanitize_callback' => 'sanitize_text_field'
    )
  );

  $wp_customize->add_control(
    'set_popular_title', array(
      'label' 		  => __( 'Popular Products Title', 'fancy-lab' ),
      'description' => __( 'Popular Products Title', 'fancy-lab' ),
      'section' 		=> 'sec_home_page',
      'type' 			  => 'text'
    )
  );

  // Field 2: Popular products limit
  $wp_customize->add_setting(
    'set_popular_max_num', array(
      'type'					    => 'theme_mod',
      'default'			    	=> '',
      'sanitize_callback'	=> 'absint'
    )
  );

  $wp_customize->add_control(
    'set_popular_max_num', array(
      'label'			  => __( 'Popular Products Max Number', 'fancy-lab' ),
      'description'	=> __( 'Popular Products Max Number', 'fancy-lab' ),
      'section'		  => 'sec_home_page',
      'type'			  => 'number'
    )
  );

  // Field 3: Popular products columns
  $wp_customize->add_setting(
    'set_popular_max_col', array(
      'type'					    => 'theme_mod',
      'default'				    => '',
      'sanitize_callback'	=> 'absint'
    )
  );

  $wp_customize->add_control(
    'set_popular_max_col', array(
      'label'			  => __( 'Popular Products Max Columns', 'fancy-lab' ),
      'description'	=> __( 'Popular Products Max Columns', 'fancy-lab' ),
      'section'		  => 'sec_home_page',
      'type'			  => 'number'
    )
  );

  // Field 4: New arrivals title
  $wp_customize->add_setting(
    'set_new_arrivals_title', array(
      'type' 			      	=> 'theme_mod',
      'default' 		    	=> '',
      'sanitize_callback' => 'sanitize_text_field'
    )
  );

  $wp_customize->add_control(
    'set_new_arrivals_title', array(
      'label' 	   	=> __( 'New Arrivals Title', 'fancy-lab' ),
      'description' => __( 'New Arrivals Title', 'fancy-lab' ),
      'section' 		=> 'sec_home_page',
      'type' 			  => 'text'
    )
  );

  // Field 5: New arrivals limit
  $wp_customize->add_setting(
    'set_new_arrivals_max_num', array(
      'type'					    => 'theme_mod',
      'default'			    	=> '',
      'sanitize_callback'	=> 'absint'
    )
  );

  $wp_customize->add_control(
    'set_new_arrivals_max_num', array(
      'label'		  	=> __( 'New Arrivals Max Number', 'fancy-lab' ),
      'description'	=> __( 'New Arrivals Max Number', 'fancy-lab' ),
      'section'		  => 'sec_home_page',
      'type'			  => 'number'
    )
  );

  // Field 6: New arrivals columns
  $wp_customize->add_setting(
    'set_new_arrivals_max_col', array(
      'type'					    => 'theme_mod',
      'default'				    => '',
      'sanitize_callback'	=> 'absint'
    )
  );

  $wp_customize->add_control(
    'set_new_arrivals_max_col', array(
      'label'			  => __( 'New Arrivals Max Columns', 'fancy-lab' ),
      'description'	=> __( 'New Arrivals Max Columns', 'fancy-lab' ),
      'section'		  => 'sec_home_page',
      'type'			  => 'number'
    )
  );

  // Field 7: Deal of the week title
  $wp_customize->add_setting(
    'set_deal_title', array(
      'type' 			      	=> 'theme_mod',
      'default' 	    		=> '',
      'sanitize_callback' => 'sanitize_text_field'
    )
  );

  $wp_customize->add_control(
    'set_deal_title', array(
      'label' 		  => __( 'Deal of the Week Title', 'fancy-lab' ),
      'description' => __( 'Deal of the Week Title', 'fancy-lab' ),
      'section' 		=> 'sec_home_page',
      'type' 			  => 'text'
    )
  );

  // Deal of the Week Checkbox
  // No native function to santiize checkbox, so create if yourself
  $wp_customize->add_setting(
    'set_deal_show', array(
      'type'					    => 'theme_mod',
      'default'			    	=> '',
      'sanitize_callback'	=> 'fancy_lab_sanitize_checkbox'
    )
  );

  $wp_customize->add_control(
    'set_deal_show', array(
      'label'			=> __( 'Show Deal of the Week?', 'fancy-lab' ),
      'section'		=> 'sec_home_page',
      'type'			=> 'checkbox'
    )
  );

  // Field 9: Deal of the week product ID
  // You can view product-id by going to `Products -> Hover on any product`
  $wp_customize->add_setting(
    'set_deal', array(
      'type'			    		=> 'theme_mod',
      'default'		    		=> '',
      'sanitize_callback'	=> 'absint'
    )
  );

  $wp_customize->add_control(
    'set_deal', array(
      'label'			  => __( 'Deal of the Week Product ID', 'fancy-lab' ),
      'description'	=> __( 'Product ID to Display', 'fancy-lab' ),
      'section'		  => 'sec_home_page',
      'type'			  => 'number'
    )
  );

  // Field 10: Blog title
  $wp_customize->add_setting(
    'set_blog_title', array(
      'type' 			    	  => 'theme_mod',
      'default' 		    	=> '',
      'sanitize_callback' => 'sanitize_text_field'
    )
  );

  $wp_customize->add_control(
    'set_blog_title', array(
      'label' 		  => __( 'Blog Section Title', 'fancy-lab' ),
      'description' => __( 'Blog Section Title', 'fancy-lab' ),
      'section' 		=> 'sec_home_page',
      'type' 			  => 'text'
    )
  );
}

add_action( 'customize_register', 'fancy_lab_customizer' );

// Sanitize checkbox function
function fancy_lab_sanitize_checkbox( $checked ) {
	return ( ( isset ( $checked ) && $checked == true ) ? true : false );
}
```

### Show the Slider in the Home Page

- Getting data from Customizer to display the Slider section.
- 4 `->` we want only 3 slides

```php
<ul class="slides">
  <?php
    /**
     * Getting data from Customizer to display the Slider section
     * 4 == we want only 3 slides
     * We started from 1 because our options in Customizer starts from 1
     */
    for ( $i = 1; $i < 4; $i++ ) {
      $slider_page_[$i] = get_theme_mod( 'set_slider_page_' . $i );
      $slider_button_text_[$i] = get_theme_mod( 'set_slider_button_text_' . $i );
      $slider_button_url_[$i] = get_theme_mod( 'set_slider_button_url_' . $i );
    }

    $args = [
      'post_type'				=> 'page',
      'posts_per_page'	=> 3,
      'post__in'				=> $slider_page_, // page-id array(1, 2..)
      'orderby'					=> 'post__in' // order by id
    ];

    $slides = new WP_Query( $args );

    $j = 1;
    while ( $slides->have_posts() ) {
      $slides->the_post(); ?>
  <li>
    <?php the_post_thumbnail( 'fancy-lab-slider', array( 'class'	=> 'img-fluid' ) ); ?>
    <div class="container">
      <div class="slider-details-container">
        <div class="slider-title">
          <h1><?php the_title(); ?></h1>
        </div>
        <div class="slider-description">
          <div class="subtitle"><?php the_content(); ?></div>
          <a class="link"
            href="<?php echo esc_url( $slider_button_url_[$j] ); ?>"><?php echo esc_html( $slider_button_text_[$j] ); ?></a>
        </div>
      </div>
    </div>
  </li>
  <?php
    $j++;
    }
      wp_reset_postdata();
    ?>
</ul>
```

## Popular Products

- Most of functionality in `WooCommerc` can be done through `shortcode`, `products` can be one of them!

### Static Product List

- This method of echoing `shortcode` will be print the products in a s static way, the user has no control over the options of number of products.
- The product list will have description in the `Home` page, which is illogic! Use `CSS` to hide the product description.
- You can use `hooks` to show the product description only in the `Shop` page.

```php
// Static query to get dynamic popular products
echo do_shortcode( '[products limit="4" columns="4" orderby="popularity"]' );
```

### Hiding the Product Description in the Home Page Using CSS

```css
.home .woocommerce-loop-product__title + p {
	display: none;
}
```

### Hiding the Product Description in the Home Page Using CSS

In `wc-modifications.php`, print the product description only in the `Shop` page.

```php
// 5. If we in Shop page, add a short description to the product
add_action( 'woocommerce_after_shop_loop_item_title', 'the_excerpt', 1 );
```

### Allow the User to Have Some Control Over Product List

- Register options in the theme customizer:

```php
function fancy_lab_customizer( $wp_customize ) {
  // Homepage Settings
  $wp_customize->add_section(
    'sec_home_page', array(
      'title'			  => __( 'Home Page Products and Blog Settings', 'fancy-lab' ),
      'description'	=> __( 'Home Page Section', 'fancy-lab' )
    )
  );

  // Field 1: Popular products title
  $wp_customize->add_setting(
    'set_popular_title', array(
      'type' 			      	=> 'theme_mod',
      'default' 		    	=> '',
      'sanitize_callback' => 'sanitize_text_field'
    )
  );

  $wp_customize->add_control(
    'set_popular_title', array(
      'label' 		  => __( 'Popular Products Title', 'fancy-lab' ),
      'description' => __( 'Popular Products Title', 'fancy-lab' ),
      'section' 		=> 'sec_home_page',
      'type' 			  => 'text'
    )
  );

  // Field 2: Popular products limit
  $wp_customize->add_setting(
    'set_popular_max_num', array(
      'type'					    => 'theme_mod',
      'default'			    	=> '',
      'sanitize_callback'	=> 'absint'
    )
  );

  $wp_customize->add_control(
    'set_popular_max_num', array(
      'label'			  => __( 'Popular Products Max Number', 'fancy-lab' ),
      'description'	=> __( 'Popular Products Max Number', 'fancy-lab' ),
      'section'		  => 'sec_home_page',
      'type'			  => 'number'
    )
  );

  // Field 3: Popular products columns
  $wp_customize->add_setting(
    'set_popular_max_col', array(
      'type'					    => 'theme_mod',
      'default'				    => '',
      'sanitize_callback'	=> 'absint'
    )
  );

  $wp_customize->add_control(
    'set_popular_max_col', array(
      'label'			  => __( 'Popular Products Max Columns', 'fancy-lab' ),
      'description'	=> __( 'Popular Products Max Columns', 'fancy-lab' ),
      'section'		  => 'sec_home_page',
      'type'			  => 'number'
    )
  );

  // Field 4: New arrivals title
  $wp_customize->add_setting(
    'set_new_arrivals_title', array(
      'type' 			      	=> 'theme_mod',
      'default' 		    	=> '',
      'sanitize_callback' => 'sanitize_text_field'
    )
  );

  $wp_customize->add_control(
    'set_new_arrivals_title', array(
      'label' 	   	=> __( 'New Arrivals Title', 'fancy-lab' ),
      'description' => __( 'New Arrivals Title', 'fancy-lab' ),
      'section' 		=> 'sec_home_page',
      'type' 			  => 'text'
    )
  );

  // Field 5: New arrivals limit
  $wp_customize->add_setting(
    'set_new_arrivals_max_num', array(
      'type'					    => 'theme_mod',
      'default'			    	=> '',
      'sanitize_callback'	=> 'absint'
    )
  );

  $wp_customize->add_control(
    'set_new_arrivals_max_num', array(
      'label'		  	=> __( 'New Arrivals Max Number', 'fancy-lab' ),
      'description'	=> __( 'New Arrivals Max Number', 'fancy-lab' ),
      'section'		  => 'sec_home_page',
      'type'			  => 'number'
    )
  );

  // Field 6: New arrivals columns
  $wp_customize->add_setting(
    'set_new_arrivals_max_col', array(
      'type'					    => 'theme_mod',
      'default'				    => '',
      'sanitize_callback'	=> 'absint'
    )
  );

  $wp_customize->add_control(
    'set_new_arrivals_max_col', array(
      'label'			  => __( 'New Arrivals Max Columns', 'fancy-lab' ),
      'description'	=> __( 'New Arrivals Max Columns', 'fancy-lab' ),
      'section'		  => 'sec_home_page',
      'type'			  => 'number'
    )
  );
}
```

- Show the options in the front end:

```php
$popular_limit	= get_theme_mod( 'set_popular_max_num', 4 );
$popular_col 		= get_theme_mod( 'set_popular_max_col', 4 );
$arrivals_limit	= get_theme_mod( 'set_new_arrivals_max_num', 4 );
$arrivals_col		= get_theme_mod( 'set_new_arrivals_max_col', 4 );

<h2><?php echo esc_html( get_theme_mod( 'set_popular_title', __( 'Popular products', 'fancy-lab' ) ) ); ?></h2>

<h2><?php echo esc_html( get_theme_mod( 'set_new_arrivals_title', __( 'New Arrivals', 'fancy-lab' ) ) ); ?></h2>

// Dynamic query to get popular products
echo do_shortcode( '[products limit=" ' . esc_attr( $popular_limit ) . ' " columns=" ' . esc_attr( $popular_col ) . ' " orderby="popularity"]' );

// Dynamic query to get new arrivals products
echo do_shortcode( '[products limit=" ' . esc_attr( $arrivals_limit ) . ' " columns=" ' . esc_attr( $arrivals_col ) . ' " orderby="date"]' );
```

## Deal of the Week Feature

- This feature/module will be optional in customizer, the user can enable/disable it using checkbox.
- `0`: By default this section is false/disabled.
- The module will have a `status`, which can be active or not active.

### Register Options in Theme Customizer

````php
function fancy_lab_customizer( $wp_customize ) {
  // Field 7: Deal of the week title
  $wp_customize->add_setting(
    'set_deal_title', array(
      'type' 			      	=> 'theme_mod',
      'default' 	    		=> '',
      'sanitize_callback' => 'sanitize_text_field'
    )
  );

  $wp_customize->add_control(
    'set_deal_title', array(
      'label' 		  => __( 'Deal of the Week Title', 'fancy-lab' ),
      'description' => __( 'Deal of the Week Title', 'fancy-lab' ),
      'section' 		=> 'sec_home_page',
      'type' 			  => 'text'
    )
  );

  // Deal of the Week Checkbox
  // No native function to santiize checkbox, so create if yourself
  $wp_customize->add_setting(
    'set_deal_show', array(
      'type'					    => 'theme_mod',
      'default'			    	=> '',
      'sanitize_callback'	=> 'fancy_lab_sanitize_checkbox'
    )
  );

  $wp_customize->add_control(
    'set_deal_show', array(
      'label'			=> __( 'Show Deal of the Week?', 'fancy-lab' ),
      'section'		=> 'sec_home_page',
      'type'			=> 'checkbox'
    )
  );

  // Field 9: Deal of the week product ID
  // You can view product-id by going to `Products -> Hover on any product`
  $wp_customize->add_setting(
    'set_deal', array(
      'type'			    		=> 'theme_mod',
      'default'		    		=> '',
      'sanitize_callback'	=> 'absint'
    )
  );

  $wp_customize->add_control(
    'set_deal', array(
      'label'			  => __( 'Deal of the Week Product ID', 'fancy-lab' ),
      'description'	=> __( 'Product ID to Display', 'fancy-lab' ),
      'section'		  => 'sec_home_page',
      'type'			  => 'number'
    )
  );
}

add_action( 'customize_register', 'fancy_lab_customizer' );

// Sanitize checkbox function
function fancy_lab_sanitize_checkbox( $checked ) {
	return ( ( isset ( $checked ) && $checked == true ) ? true : false );
}
``

```php
/**
 * This option will be optional in customizer, the user can enable/disable it using checkbox
 * 0: by default this section is false/disabled
 */
$showDeal       = get_theme_mod( 'set_deal_show', 0 ); // status
$dealProductId  = get_theme_mod( 'set_deal' ); // product-id
$currency       = get_woocommerce_currency_symbol(); // woocom settings
// get_post_meta(id, DB_field_name, isRenderedToScreen?)
$regular	= get_post_meta( $dealProductId, '_regular_price', true );
$sale 		= get_post_meta( $dealProductId, '_sale_price', true );

if ( $showDeal == 1 && ( !empty( $dealProductId ) ) ):
  // Simple equation to calculate discount percentage
  $discount       = absint( 100 - ( ( $sale / $regular ) * 100 ) );
  $discount_rate  = '%' . $discount;
  ?>
<!-- Deal of the week -->
<section class="deal-of-the-week">
<div class="container">
  <div class="section-title">
    <h2><?php echo esc_html( get_theme_mod( 'set_deal_title', __( 'Deal of the Week', 'fancy-lab' ) ) ); ?></h2>
  </div>
  <div class="row d-flex align-items-center">
    <div class="deal-img col-md-6 col-12 ml-auto text-center">
      <?php
      /**
       * Because we are outside the loop and we don't know the post-id, we use (echo get_the_post_thumbnail( $id, $img-size, $extras ))
       * You have to choose a $dealProductId or post-id in customizer to show the image
       */
      echo get_the_post_thumbnail( $dealProductId, 'large', array( 'class' => 'img-fluid' ) ); ?>
    </div>
    <div class="deal-desc col-md-4 col-12 mr-auto text-center">

      <?php
      // The condition is to ensuare that no 100% discount!
      if ( !empty( $sale ) ): ?>
      <span class="discount">
        <?php echo esc_html( $discount_rate ) . esc_html__( ' OFF', 'fancy-lab' ); ?>
      </span>
      <?php endif; ?>
      <h3>
        <a
          href="<?php echo esc_url( get_permalink( $dealProductId ) ); ?>"><?php echo esc_html( get_the_title( $dealProductId ) ); ?></a>
      </h3>
      <p><?php echo esc_html( get_the_excerpt( $dealProductId ) ); ?></p>
      <div class="prices">
        <span class="regular">
          <?php
            echo esc_html( $currency );
            echo esc_html( $regular );
          ?>
        </span>
        <?php if ( !empty( $sale ) ): ?>
        <span class="sale">
          <?php
            echo esc_html( $currency );
            echo esc_html( $sale );
            ?>
        </span>
        <?php endif; ?>
      </div>
      <!-- Give the id of the item to be added to cart -->
      <a href="<?php echo esc_url( '?add-to-cart=' . $dealProductId ); ?>"
        class="add-to-cart"><?php esc_html_e( 'Add to Cart', 'fancy-lab' ); ?></a>
    </div>
  </div>
</div>
</section>
<!-- deal-of-the-week-end -->

<?php endif; // end showing deal section ?>
````
